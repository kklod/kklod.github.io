define(["dom","multiSelect","layoutManager","cardBuilder","listView","playbackManager","userSettings","alphaPicker","connectionManager","focusManager","loading","globalize","browser","baseTab"],function(dom,MultiSelect,layoutManager,cardBuilder,listView,playbackManager,userSettings,AlphaPicker,connectionManager,focusManager,loading,globalize,browser,BaseTab){"use strict";function trySelectValue(instance,scroller,view,value,focus){value&&"#"!==value?instance.getItems({Limit:0}).then(function(totalResult){instance.getItems({Limit:0,NameStartsWithOrGreater:value}).then(function(result){instance.itemsContainer.scrollToIndex(Math.max(totalResult.TotalRecordCount-result.TotalRecordCount,0),{},focus)})}):instance.itemsContainer.scrollToIndex(0,{},focus)}function initAlphaPicker(instance,view){instance.itemsContainer=view.querySelector(".itemsContainer"),instance.alphaPicker=new AlphaPicker({element:instance.alphaPickerElement,itemsContainer:instance.itemsContainer,prefixes:[],setValueOnFocus:!0}),instance.alphaPicker.on("alphavaluechanged",function(e){var value=e.detail.value;this.scroller,trySelectValue(this,0,this.itemsContainer,value)}.bind(instance))}function showFilterMenu(){var instance=this;require(["filterMenu"],function(FilterMenu){(new FilterMenu).show({settingsKey:instance.getSettingsKey(),settings:instance.getFilters(),visibleSettings:instance.getVisibleFilters(),onChange:instance.itemsContainer.refreshItems.bind(instance.itemsContainer),parentId:instance.isGlobalQuery()?null:instance.params.parentId,itemTypes:instance.getItemTypes?instance.getItemTypes():[],serverId:instance.apiClient.serverId(),filterMenuOptions:instance.getFilterMenuOptions()}).then(function(){refreshAfterSettingsChange(instance)})})}function getSortMenuOption(sortMenuOptions,sortBy){for(var i=0,length=sortMenuOptions.length;i<length;i++){var option=sortMenuOptions[i];if(option.value===sortBy)return option}return null}function getDefaultSortOrder(sortMenuOptions,sortBy){if(sortBy){var option=getSortMenuOption(sortMenuOptions,sortBy);if(option&&option.value===sortBy&&option.defaultSortOrder)return option.defaultSortOrder;if((sortBy=sortBy.toLowerCase()).startsWith("sortname")||sortBy.startsWith("runtime")||sortBy.startsWith("album")||sortBy.startsWith("isfolder")||sortBy.startsWith("channelnumber"))return"Ascending"}return"Descending"}function showSortMenu(e){var instance=this;require(["actionsheet"],function(actionsheet){var options=instance.getSortMenuOptions();!function(instance,options){for(var currentValues=instance.getSortValues(options),i=0,length=options.length;i<length;i++){var icon,opt=options[i];opt.selected=opt.value===currentValues.sortBy,opt.selected&&(icon="Descending"===currentValues.sortOrder?"&#xE5DB;":"&#xE5D8;",opt.asideIcon=icon)}}(instance,options),options.sort(compareByName),actionsheet.show({items:options,positionTo:e.target.closest("button"),title:globalize.translate("LabelSortBy"),positionY:"bottom",hideTitleWhenNotFullscreen:!0,offsetTop:2}).then(function(value){var currentValues=instance.getSortValues(options),sortOrder=currentValues.sortOrder,sortOrder=currentValues.sortBy===value?"Ascending"===sortOrder?"Descending":"Ascending":getDefaultSortOrder(options,value),settingsKey=instance.getSettingsKey();userSettings.setFilter(instance.getSortBySettingsKey(),value),userSettings.setFilter(settingsKey+"-sortorder",sortOrder),updateSortText(instance),refreshAfterSettingsChange(instance)})})}function showViewSettingsMenu(){var instance=this;require(["viewSettings"],function(ViewSettings){(new ViewSettings).show({settingsKey:instance.getSettingsKey(),settings:instance.getViewSettings(),visibleSettings:instance.getVisibleViewSettings()}).then(function(){refreshAfterSettingsChange(instance)})})}function refreshAfterSettingsChange(instance){instance.itemsContainer.refreshItems()}function updateSortText(instance){var btnSortText=instance.btnSortText;if(btnSortText){for(var options=instance.getSortMenuOptions(),values=instance.getSortValues(options),sortBy=values.sortBy,i=0,length=options.length;i<length;i++)if(sortBy===options[i].value){btnSortText.innerHTML=globalize.translate("SortByValue",options[i].name);break}var btnSortIcon=instance.btnSortIcon;btnSortIcon&&(btnSortIcon.innerHTML="Descending"===values.sortOrder?"&#xE5DB;":"&#xE5D8;")}}function bindAll(elems,eventName,fn){for(var i=0,length=elems.length;i<length;i++)elems[i].addEventListener(eventName,fn)}function hideOrShowAll(elems,hide){for(var i=0,length=elems.length;i<length;i++)hide?elems[i].classList.add("hide"):elems[i].classList.remove("hide")}function afterRefresh(result){var instance,numItems,alphaPicker,values,alphaPickerAllowed,items=result.Items||result,totalRecordCount=result.TotalRecordCount||items.length;!function(view,totalRecordCount){var elem=view.querySelector(".listTotalRecordCount");elem&&(elem.innerHTML=1===totalRecordCount?globalize.translate("ValueOneItem"):globalize.translate("ItemCount",totalRecordCount))}(this.view,totalRecordCount),totalRecordCount||this.setEmptyListState(),numItems=totalRecordCount,values=(instance=this).getSortValues(),(alphaPickerAllowed="SortName"===values.sortBy&&"Ascending"===values.sortOrder)?instance.initAlphaNumericShortcuts():instance.destroyAlphaNumericShortcuts(),!instance.alphaPicker||(alphaPicker=instance.alphaPickerElement)&&(alphaPickerAllowed&&30<numItems?(alphaPicker.classList.remove("hide"),layoutManager.tv?(alphaPicker.classList.add("alphaPicker-fixed-left"),alphaPicker.classList.remove("alphaPicker-fixed-right")):(alphaPicker.classList.remove("alphaPicker-fixed-left"),alphaPicker.classList.add("alphaPicker-fixed-right")),instance.refreshPrefixes()):alphaPicker.classList.add("hide")),hideOrShowAll(this.view.querySelectorAll(".btnPlay"),!totalRecordCount),hideOrShowAll(this.view.querySelectorAll(".btnShuffle"),!(totalRecordCount&&this.supportsShuffle()))}function ItemsTab(view,params){BaseTab.apply(this,arguments),this.view=view,(this.params=params).serverId&&(this.apiClient=connectionManager.getApiClient(params.serverId))}function mapPrefix(i){return i.Name}function compareByName(a,b){var aName=a.menuSortKey||a.name,bName=b.menuSortKey||b.name;return aName<bName?-1:bName<aName?1:0}return Object.assign(ItemsTab.prototype,BaseTab.prototype),ItemsTab.prototype.onTemplateLoaded=function(){var hasAnyViewSettings,view=this.view,params=this.params;this.itemsContainer=view.querySelector(".itemsContainer"),this.itemsContainer.setListClasses=!0,this.itemsContainer.fetchData=this.getItems.bind(this),this.itemsContainer.virtualChunkSize=this.virtualChunkSize(),this.itemsContainer.getListOptions=this.getListOptions.bind(this),this.itemsContainer.afterRefresh=afterRefresh.bind(this),this.addFocusBehavior(this.itemsContainer),params.parentId&&!this.isGlobalQuery()&&this.itemsContainer.setAttribute("data-parentid",params.parentId);for(var btnViewSettings=view.querySelectorAll(".btnViewSettings"),i=0,length=btnViewSettings.length;i<length;i++)hasAnyViewSettings=!0,btnViewSettings[i].addEventListener("click",showViewSettingsMenu.bind(this));var filterButtons=view.querySelectorAll(".btnFilter");this.filterButtons=filterButtons;var hasVisibleFilters=this.getVisibleFilters().length;for(i=0,length=filterButtons.length;i<length;i++){var btnFilter=filterButtons[i];btnFilter.addEventListener("click",showFilterMenu.bind(this)),hasVisibleFilters?(hasAnyViewSettings=!0,btnFilter.classList.remove("hide")):btnFilter.classList.add("hide")}var sortButtons=view.querySelectorAll(".btnSort");for(i=0,length=(this.sortButtons=sortButtons).length;i<length;i++){hasAnyViewSettings=!0;var sortButton=sortButtons[i];sortButton.addEventListener("click",showSortMenu.bind(this)),"nextup"!==params.type&&sortButton.classList.remove("hide")}this.btnSortText=view.querySelector(".btnSortText"),this.btnSortIcon=view.querySelector(".btnSortIcon"),this.enableAlphaNumericShortcuts="true"===this.itemsContainer.getAttribute("data-alphanumericshortcuts")&&this.enableVirtualData(),this.alphaPickerElement=view.querySelector(".alphaPicker");var btnPlay=view.querySelectorAll(".btnPlay"),btnShuffle=view.querySelectorAll(".btnShuffle");bindAll(btnPlay,"click",function(){MultiSelect.canPlay()?MultiSelect.play():this.getItems({Limit:300}).then(function(result){playbackManager.play({items:result.Items||result})})}.bind(this)),bindAll(btnShuffle,"click",function(){this.getItems({SortBy:"Random",Limit:300}).then(function(result){playbackManager.play({items:result.Items||result})})}.bind(this)),(btnPlay.length||btnShuffle.length)&&(hasAnyViewSettings=!0);var itemsViewSettingsContainer=view.querySelector(".itemsViewSettingsContainer");itemsViewSettingsContainer&&(hasAnyViewSettings?(itemsViewSettingsContainer.classList.add("focusable"),itemsViewSettingsContainer.setAttribute("data-focusabletype","autofocus"),itemsViewSettingsContainer.classList.remove("hide")):(itemsViewSettingsContainer.classList.add("hide"),itemsViewSettingsContainer.classList.remove("focusable"),itemsViewSettingsContainer.removeAttribute("data-focusabletype")))},ItemsTab.prototype.refreshPrefixes=function(){var instance=this;instance.prefixesLoaded||this.getPrefixes().then(function(prefixes){instance.prefixesLoaded=!0,instance.alphaPicker.setPrefixes(prefixes)})},ItemsTab.prototype.getPrefixes=function(){var queryInfo=this.getQueryInfo(!1),apiClient=this.apiClient,query=queryInfo.query;query.SortBy=null,query.SortOrder=null,query.StartIndex=null,query.Limit=null,query.Fields=null,query.EnableImageTypes=null,query.ImageTypeLimit=null,query.NameStartsWithOrGreater=null,query.IncludeItemTypes=this.getPrefixQueryIncludeItemTypes().join(",")||null;var methodName=this.getPrefixesApiClientMethodName(),promise="getLiveTvChannelTagPrefixes"===methodName?apiClient[methodName](query):apiClient[methodName](apiClient.getCurrentUserId(),query);return promise.then(function(result){return result.map(mapPrefix)})},ItemsTab.prototype.getPrefixesApiClientMethodName=function(){return"getPrefixes"},ItemsTab.prototype.getListViewOptions=function(items,settings){var options={fields:[],multiSelect:!0};return options},ItemsTab.prototype.getListOptions=function(items){var settings=this.getViewSettings();return"list"===settings.imageType?{renderer:listView,options:this.getListViewOptions(items,settings),virtualScrollLayout:"vertical"}:{renderer:cardBuilder,options:this.getCardOptions(items,settings),virtualScrollLayout:"vertical-grid"}},ItemsTab.prototype.enableVirtualData=function(){return this.itemsContainer.hasAttribute("data-virtualscrolllayout")},ItemsTab.prototype.virtualChunkSize=function(){return null},ItemsTab.prototype.getCardOptions=function(items,settings){var shape,preferThumb,preferDisc,preferLogo;"banner"===settings.imageType?shape="banner":"disc"===settings.imageType?(shape="square",preferDisc=!0):"logo"===settings.imageType?(shape="backdrop",preferLogo=!0):"thumb"===settings.imageType?(shape="backdrop",preferThumb=!0):shape="auto";var visibleFields=settings.fields,options={shape:shape,preferThumb:preferThumb,preferDisc:preferDisc,preferLogo:preferLogo,fields:visibleFields,overlayText:0===visibleFields.length||"None"===visibleFields[0],context:this.getContext(),parentId:this.isGlobalQuery()?null:this.params.parentId,playAction:this.getPlayAction()};return options.centerText=!options.overlayText,options.multiSelect=!0,options},ItemsTab.prototype.getPlayAction=function(){return null},ItemsTab.prototype.getContext=function(){return null},ItemsTab.prototype.supportsShuffle=function(){return!0},ItemsTab.prototype.getPrefixQueryIncludeItemTypes=function(){return this.getQueryIncludeItemTypes()},ItemsTab.prototype.getQueryIncludeItemTypes=function(){return this.getItemTypes()},ItemsTab.prototype.getBaseQuery=function(){var sortMenuOptions=this.getSortMenuOptions(),sortValues=this.getSortValues(sortMenuOptions),fields="BasicSyncInfo,CanDelete",settings=this.getViewSettings();"primary"!==settings.imageType&&"list"!==settings.imageType||(fields+=",PrimaryImageAspectRatio");var visibleFields=settings.fields;visibleFields.includes("ProductionYear")&&(fields+=",ProductionYear"),visibleFields.includes("CommunityRating")&&(fields+=",CommunityRating"),visibleFields.includes("OfficialRating")&&(fields+=",OfficialRating"),visibleFields.includes("CriticRating")&&(fields+=",CriticRating");var imageTypes="Primary,Backdrop,Thumb";"banner"===settings.imageType?imageTypes+=",Banner":"disc"===settings.imageType?imageTypes+=",Disc":"logo"===settings.imageType&&(imageTypes+=",Logo");var sortMenuOption,sortOrder=sortValues.sortOrder;return sortValues.sortBy&&sortOrder&&((sortMenuOption=getSortMenuOption(sortMenuOptions,sortValues.sortBy))&&sortMenuOption["sortOrder"+sortOrder]&&(sortOrder=sortMenuOption["sortOrder"+sortOrder])),{SortBy:sortValues.sortBy,SortOrder:sortOrder,IncludeItemTypes:this.getQueryIncludeItemTypes().join(","),Recursive:!0,Fields:fields,ImageTypeLimit:1,EnableImageTypes:imageTypes,StartIndex:0,ParentId:this.isGlobalQuery()?null:this.params.parentId}},ItemsTab.prototype.getQueryInfo=function(enableFilters){var hasFilters,filters,query=this.getBaseQuery(),queryFilters=[];"unwatched"===this.mode?queryFilters.push("IsUnplayed"):this.options&&"favorites"===this.options.mode&&queryFilters.push("IsFavorite"),!1!==enableFilters&&((filters=this.getFilters()).SeriesStatus&&(query.SeriesStatus=filters.SeriesStatus,hasFilters=!0),filters.IsPlayed&&(queryFilters.push("IsPlayed"),hasFilters=!0),filters.IsUnplayed&&(queryFilters.push("IsUnplayed"),hasFilters=!0),filters.IsFavorite&&(queryFilters.push("IsFavorite"),hasFilters=!0),filters.IsResumable&&(queryFilters.push("IsResumable"),hasFilters=!0),filters.Containers&&(hasFilters=!0,query.Containers=filters.Containers),filters.AudioCodecs&&(hasFilters=!0,query.AudioCodecs=filters.AudioCodecs),filters.AudioLanguages&&(hasFilters=!0,query.AudioLanguages=filters.AudioLanguages),filters.VideoCodecs&&(hasFilters=!0,query.VideoCodecs=filters.VideoCodecs),filters.SubtitleCodecs&&(hasFilters=!0,query.SubtitleCodecs=filters.SubtitleCodecs),filters.SubtitleLanguages&&(hasFilters=!0,query.SubtitleLanguages=filters.SubtitleLanguages),filters.GenreIds&&(hasFilters=!0,query.GenreIds=filters.GenreIds),filters.OfficialRatings&&(hasFilters=!0,query.OfficialRatings=filters.OfficialRatings),filters.StudioIds&&(hasFilters=!0,query.StudioIds=filters.StudioIds),filters.TagIds&&(hasFilters=!0,query.TagIds=filters.TagIds),filters.Years&&(hasFilters=!0,query.Years=filters.Years),filters.Is4K&&(hasFilters=query.Is4K=!0),filters.IsHD&&(hasFilters=query.IsHD=!0),filters.IsSD&&(hasFilters=!(query.IsHD=!1)),filters.Is3D&&(hasFilters=query.Is3D=!0),null!=filters.HasSubtitles&&(query.HasSubtitles=filters.HasSubtitles,hasFilters=!0),null!=filters.ChannelMappingStatus&&(query.ChannelMappingStatus=filters.ChannelMappingStatus,hasFilters=!0),null!=filters.HasTrailer&&(query.HasTrailer=filters.HasTrailer,hasFilters=!0),null!=filters.HasSpecialFeature&&(query.HasSpecialFeature=filters.HasSpecialFeature,hasFilters=!0),null!=filters.HasThemeSong&&(query.HasThemeSong=filters.HasThemeSong,hasFilters=!0),null!=filters.HasThemeVideo&&(query.HasThemeVideo=filters.HasThemeVideo,hasFilters=!0),null!=filters.HasOverview&&(query.HasOverview=filters.HasOverview,hasFilters=!0),null!=filters.HasImdbId&&(query.HasImdbId=filters.HasImdbId,hasFilters=!0),null!=filters.HasTvdbId&&(query.HasTvdbId=filters.HasTvdbId,hasFilters=!0),null!=filters.HasTmdbId&&(query.HasTmdbId=filters.HasTmdbId,hasFilters=!0),null!=filters.IsLocked&&(query.IsLocked=filters.IsLocked,hasFilters=!0)),query.Filters=queryFilters.length?queryFilters.join(","):null;var settings=this.getViewSettings();return settings.groupItemsIntoCollections?query.GroupItemsIntoCollections=!0:settings.groupItemsIntoTags&&(query.GroupItemsInto="Tags"),{query:query,hasFilters:hasFilters}},ItemsTab.prototype.getItems=function(baseQuery,signal){var queryInfo=this.getQueryInfo();this.setFilterStatus(queryInfo.hasFilters);var apiClient=this.apiClient,query=Object.assign(queryInfo.query,baseQuery||{}),methodName=this.getApiClientQueryMethodName();return"getLiveTvRecordings"===methodName||"getLiveTvChannelTags"===methodName?(query.UserId=apiClient.getCurrentUserId(),apiClient[methodName](query,signal)):apiClient[methodName](apiClient.getCurrentUserId(),query,signal)},ItemsTab.prototype.getApiClientQueryMethodName=function(){return"getItems"},ItemsTab.prototype.getViewSettingDefaults=function(currentItem,listItems,allowedVisibleFields){var defaults={imageType:"primary",fields:[]};currentItem&&"PhotoAlbum"===currentItem.Type||defaults.fields.push("Name");this.params;return allowedVisibleFields.includes("ProductionYear")&&defaults.fields.includes("Name")&&defaults.fields.push("ProductionYear"),defaults},ItemsTab.prototype.getViewSettings=function(){var basekey=this.getSettingsKey(),visibleFields=this.getVisibleViewSettings().fields||[],item=this.currentItem,defaults=this.getViewSettingDefaults(item,[],visibleFields),userConfiguredFields=userSettings.get(basekey+"-fields");return{fields:userConfiguredFields=userConfiguredFields?userConfiguredFields.split(","):defaults.fields,groupItemsIntoTags:"true"===userSettings.get(basekey+"-groupItemsIntoTags"),groupItemsIntoCollections:"true"===userSettings.get(basekey+"-groupItemsIntoCollections"),imageType:userSettings.get(basekey+"-imageType")||defaults.imageType}},ItemsTab.prototype.getSettingsKey=function(){return this.params.parentId+"-1"},ItemsTab.prototype.initAlphaNumericShortcuts=function(){var instance;this.enableAlphaNumericShortcuts&&(this.alphaNumericShortcuts||(instance=this,require(["alphaNumericShortcuts"],function(AlphaNumericShortcuts){instance.alphaNumericShortcuts=new AlphaNumericShortcuts({itemsContainer:instance.itemsContainer}),instance.alphaNumericShortcuts.onAlphaNumericValueEntered=function(value){trySelectValue(this,this.scroller,this.view,value,!0)}.bind(instance)})))},ItemsTab.prototype.onResume=function(options){BaseTab.prototype.onResume.apply(this,arguments),options&&options.refresh&&(updateSortText(this),loading.show());var view=this.view;this.enableAlphaPicker&&!this.alphaPicker&&initAlphaPicker(this,view);var alphaNumericShortcuts=this.alphaNumericShortcuts;alphaNumericShortcuts&&alphaNumericShortcuts.resume();var instance=this,autoFocus=options.autoFocus;this.itemsContainer.resume(options).then(function(result){loading.hide(),autoFocus&&focusManager.autoFocus(instance.itemsContainer)})},ItemsTab.prototype.refresh=function(options){loading.show();var instance=this,autoFocus=options.autoFocus;this.itemsContainer.refreshItems(options).then(function(result){loading.hide(),autoFocus&&focusManager.autoFocus(instance.itemsContainer)})},ItemsTab.prototype.getVisibleViewSettings=function(){var params=this.params;if("downloads"===params.parentId)return{};if("search"===params.type)return{};var item=this.currentItem,fields=["Name"],settings=[];return"Person"!==params.type&&"MusicArtist"!==params.type&&"nextup"!==params.type&&"Program"!==params.type&&(item&&(item.CollectionType||"CollectionFolder"===item.Type||"UserView"===item.Type||"Channel"===item.Type)||(fields.push("ProductionYear"),fields.push("CommunityRating"),fields.push("CriticRating"),fields.push("OfficialRating"))),item&&("PhotoAlbum"===item.Type||"ChannelFolderItem"===item.Type)||settings.push("imageType"),{settings:settings,fields:fields}},ItemsTab.prototype.getFilters=function(){var basekey=this.getSettingsKey();return{IsPlayed:"true"===userSettings.getFilter(basekey+"-filter-IsPlayed"),IsUnplayed:"true"===userSettings.getFilter(basekey+"-filter-IsUnplayed"),IsFavorite:"true"===userSettings.getFilter(basekey+"-filter-IsFavorite"),IsResumable:"true"===userSettings.getFilter(basekey+"-filter-IsResumable"),Is4K:"true"===userSettings.getFilter(basekey+"-filter-Is4K"),IsHD:"true"===userSettings.getFilter(basekey+"-filter-IsHD"),IsSD:"true"===userSettings.getFilter(basekey+"-filter-IsSD"),Is3D:"true"===userSettings.getFilter(basekey+"-filter-Is3D"),VideoTypes:userSettings.getFilter(basekey+"-filter-VideoTypes"),SeriesStatus:userSettings.getFilter(basekey+"-filter-SeriesStatus"),HasSubtitles:userSettings.getFilter(basekey+"-filter-HasSubtitles"),ChannelMappingStatus:userSettings.getFilter(basekey+"-filter-ChannelMappingStatus"),HasTrailer:userSettings.getFilter(basekey+"-filter-HasTrailer"),HasSpecialFeature:userSettings.getFilter(basekey+"-filter-HasSpecialFeature"),HasThemeSong:userSettings.getFilter(basekey+"-filter-HasThemeSong"),HasThemeVideo:userSettings.getFilter(basekey+"-filter-HasThemeVideo"),HasOverview:userSettings.getFilter(basekey+"-filter-HasOverview"),HasImdbId:userSettings.getFilter(basekey+"-filter-HasImdbId"),HasTvdbId:userSettings.getFilter(basekey+"-filter-HasTvdbId"),HasTmdbId:userSettings.getFilter(basekey+"-filter-HasTmdbId"),IsLocked:userSettings.getFilter(basekey+"-filter-IsLocked"),GenreIds:userSettings.getFilter(basekey+"-filter-GenreIds"),StudioIds:userSettings.getFilter(basekey+"-filter-StudioIds"),TagIds:userSettings.getFilter(basekey+"-filter-TagIds"),OfficialRatings:userSettings.getFilter(basekey+"-filter-OfficialRatings"),Containers:userSettings.getFilter(basekey+"-filter-Containers"),AudioCodecs:userSettings.getFilter(basekey+"-filter-AudioCodecs"),AudioLanguages:userSettings.getFilter(basekey+"-filter-AudioLanguages"),SubtitleLanguages:userSettings.getFilter(basekey+"-filter-SubtitleLanguages"),VideoCodecs:userSettings.getFilter(basekey+"-filter-VideoCodecs"),SubtitleCodecs:userSettings.getFilter(basekey+"-filter-SubtitleCodecs"),Years:userSettings.getFilter(basekey+"-filter-Years")}},ItemsTab.prototype.getSortBySettingsKey=function(sortMenuOptions){return this.getSettingsKey()+"-sortby"},ItemsTab.prototype.getSortByValue=function(){return userSettings.getFilter(this.getSortBySettingsKey())},ItemsTab.prototype.getSortValues=function(sortMenuOptions){var basekey=this.getSettingsKey(),sortBy=this.getSortByValue(),sortOrder=sortBy?"Descending"===userSettings.getFilter(basekey+"-sortorder")?"Descending":"Ascending":(sortBy=this.getDefaultSortBy(),getDefaultSortOrder(sortMenuOptions=sortMenuOptions||this.getSortMenuOptions(),sortBy));return{sortBy:sortBy,sortOrder:sortOrder}},ItemsTab.prototype.getVisibleFilters=function(){return[]},ItemsTab.prototype.getDefaultSortBy=function(){return"SortName"},ItemsTab.prototype.sortOptionsByName=function(options){options.sort(compareByName)},ItemsTab.prototype.getSortMenuOptions=function(){var sortBy=[],option=this.getNameSortOption();return option&&sortBy.push(option),(option=this.getFolderSortOption())&&sortBy.push(option),(option=this.getCommunityRatingSortOption())&&sortBy.push(option),(option=this.getCriticRatingSortOption())&&sortBy.push(option),(option=this.getDateAddedSortOption())&&sortBy.push(option),(option=this.getDatePlayedSortOption())&&sortBy.push(option),(option=this.getFavoritesSortOption())&&sortBy.push(option),(option=this.getParentalRatingSortOption())&&sortBy.push(option),(option=this.getPlayCountSortOption())&&sortBy.push(option),(option=this.getReleaseDateSortOption())&&sortBy.push(option),(option=this.getRuntimeSortOption())&&sortBy.push(option),(option=this.getChannelNumberSortOption())&&sortBy.push(option),this.sortOptionsByName(sortBy),sortBy},ItemsTab.prototype.getChannelNumberSortOption=function(){return null},ItemsTab.prototype.getFavoritesSortOption=function(){return null},ItemsTab.prototype.getDateAddedSortOption=function(){return{name:globalize.translate("DateAdded"),value:"DateCreated,SortName",defaultSortOrder:"Descending"}},ItemsTab.prototype.getParentalRatingSortOption=function(){return{name:globalize.translate("ParentalRating"),value:"OfficialRating,SortName",defaultSortOrder:"Descending"}},ItemsTab.prototype.getRuntimeSortOption=function(){return{name:globalize.translate("Runtime"),value:"Runtime,SortName",defaultSortOrder:"Ascending"}},ItemsTab.prototype.getNameSortOption=function(){return{name:globalize.translate("Title"),value:"SortName",defaultSortOrder:"Ascending"}},ItemsTab.prototype.getReleaseDateSortOption=function(){return{name:globalize.translate("ReleaseDate"),value:"ProductionYear,PremiereDate,SortName",defaultSortOrder:"Descending"}},ItemsTab.prototype.isGlobalQuery=function(){return!1},ItemsTab.prototype.getFolderSortOption=function(){return null},ItemsTab.prototype.getPlayCountSortOption=function(){return{name:globalize.translate("PlayCount"),value:"PlayCount,SortName",defaultSortOrder:"Descending"}},ItemsTab.prototype.getDatePlayedSortOption=function(){return{name:globalize.translate("DatePlayed"),value:"DatePlayed,SortName",defaultSortOrder:"Descending"}},ItemsTab.prototype.getCriticRatingSortOption=function(){return{name:globalize.translate("CriticRating"),value:"CriticRating,SortName",defaultSortOrder:"Descending"}},ItemsTab.prototype.getCommunityRatingSortOption=function(){return{name:this.getCommunityRatingOptionName(),value:"CommunityRating,SortName",defaultSortOrder:"Descending"}},ItemsTab.prototype.getCommunityRatingOptionName=function(){return globalize.translate("CommunityRating")},ItemsTab.prototype.getFilterMenuOptions=function(){return{}},ItemsTab.prototype.getItemTypes=function(){return[]},ItemsTab.prototype.setFilterStatus=function(hasFilters){var filterButtons=this.filterButtons;if(filterButtons.length)for(var i=0,length=filterButtons.length;i<length;i++){var btnFilter=filterButtons[i];hasFilters?btnFilter.classList.add("filter-active"):btnFilter.classList.remove("filter-active")}},ItemsTab.prototype.destroyAlphaNumericShortcuts=function(){var alphaNumericShortcuts=this.alphaNumericShortcuts;alphaNumericShortcuts&&(alphaNumericShortcuts.destroy(),this.alphaNumericShortcuts=null)},ItemsTab.prototype.onPause=function(){BaseTab.prototype.onPause.apply(this,arguments);var itemsContainer=this.itemsContainer;itemsContainer&&itemsContainer.pause&&itemsContainer.pause();var alphaNumericShortcuts=this.alphaNumericShortcuts;alphaNumericShortcuts&&alphaNumericShortcuts.pause()},ItemsTab.prototype.getEmptyListMessage=function(){if(this.getQueryInfo(!0).hasFilters){var html="<div>"+globalize.translate("NoItemsMatchingFound")+"</div>";return html+='<button style="margin-top:2em;" type="button" is="emby-button" class="raised btnClearFilters">',html+='<i class="md-icon button-icon button-icon-left">&#xe0b8;</i>',html+="<span>"+globalize.translate("HeaderClearFilters")+"</span>",html+="</button>",Promise.resolve(html)}return Promise.resolve(globalize.translate("NoItemsFound"))},ItemsTab.prototype.clearFilters=function(){var basekey=this.getSettingsKey();userSettings.remove(basekey+"-filter-IsPlayed"),userSettings.remove(basekey+"-filter-IsUnplayed"),userSettings.remove(basekey+"-filter-IsFavorite"),userSettings.remove(basekey+"-filter-IsResumable"),userSettings.remove(basekey+"-filter-Is4K"),userSettings.remove(basekey+"-filter-IsHD"),userSettings.remove(basekey+"-filter-IsSD"),userSettings.remove(basekey+"-filter-Is3D"),userSettings.remove(basekey+"-filter-SeriesStatus"),userSettings.remove(basekey+"-filter-HasSubtitles"),userSettings.remove(basekey+"-filter-ChannelMappingStatus"),userSettings.remove(basekey+"-filter-HasTrailer"),userSettings.remove(basekey+"-filter-HasSpecialFeature"),userSettings.remove(basekey+"-filter-HasThemeSong"),userSettings.remove(basekey+"-filter-HasThemeVideo"),userSettings.remove(basekey+"-filter-HasOverview"),userSettings.remove(basekey+"-filter-HasImdbId"),userSettings.remove(basekey+"-filter-HasTvdbId"),userSettings.remove(basekey+"-filter-HasTmdbId"),userSettings.remove(basekey+"-filter-IsLocked"),userSettings.remove(basekey+"-filter-GenreIds"),userSettings.remove(basekey+"-filter-StudioIds"),userSettings.remove(basekey+"-filter-TagIds"),userSettings.remove(basekey+"-filter-OfficialRatings"),userSettings.remove(basekey+"-filter-Containers"),userSettings.remove(basekey+"-filter-AudioCodecs"),userSettings.remove(basekey+"-filter-AudioLanguages"),userSettings.remove(basekey+"-filter-SubtitleLanguages"),userSettings.remove(basekey+"-filter-VideoCodecs"),userSettings.remove(basekey+"-filter-SubtitleCodecs"),userSettings.remove(basekey+"-filter-Years"),this.itemsContainer.refreshItems()},ItemsTab.prototype.setEmptyListState=function(){this.getEmptyListMessage().then(function(html){html='<div class="flex padded-top align-items-center justify-content-center flex-grow flex-direction-column">'+html,html+="</div>",this.itemsContainer.innerHTML=html;var btnClearFilters=this.itemsContainer.querySelector(".btnClearFilters");btnClearFilters&&dom.addEventListener(btnClearFilters,"click",this.clearFilters.bind(this),{})}.bind(this))},ItemsTab.prototype.destroy=function(){BaseTab.prototype.destroy.apply(this,arguments),this.destroyAlphaNumericShortcuts(),this.view=null,this.itemsContainer=null,this.params=null,this.apiClient=null,this.filterButtons=null,this.alphaPicker&&(this.alphaPicker.destroy(),this.alphaPicker=null),this.sortButtons=null,this.btnSortText=null,this.btnSortIcon=null,this.alphaPickerElement=null,this.prefixesLoaded=null,this.scrollOnNextRefresh=null},ItemsTab});